# Write your MySQL query statement below
select 
visited_on,
(
    select sum(amount)
from customer
where visited_on between Date_Sub(c.visited_on, Interval 6 Day) And c.visited_on) as amount,
Round(
    ( 
        select sum(amount)/7
    from customer
    where visited_on between Date_Sub(c.visited_on, Interval 6 Day) And c.visited_on), 2)
    as average_amount
    from customer c
    where visited_on>=(
        select Date_Add(Min(visited_on),Interval 6 Day)from customer
    )
    group by visited_on;
